name: .NET 4.8 Release

on:
  push:
    tags:
      - 'v*.*.*'  # Trigger on version tags (e.g., v1.0.0)

jobs:
  build:
    runs-on: windows-latest  # Use a Windows runner for .NET Framework

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Setup .NET Framework
        run: |
          choco install dotnetfx --version=4.8.0 --params="'/InstallDir:C:\Program Files\dotnetfx'"  # Install .NET Framework 4.8

      - name: Restore dependencies
        run: |
          "C:\Program Files\dotnetfx\dotnet.exe" restore YourProject.sln  # Replace with your solution file

      - name: Build
        run: |
          "C:\Program Files\dotnetfx\dotnet.exe" build YourProject.sln --configuration Release  # Replace with your solution file

      - name: Publish
        run: |
          "C:\Program Files\dotnetfx\dotnet.exe" publish YourProject.sln --configuration Release --output ./output  # Replace with your solution file

  release:
    runs-on: windows-latest  # Use a Windows runner for creating the release

    needs: build  # Ensure the build job is completed before this job runs

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Create Release
        id: create_release
        uses: softprops/action-gh-release@v1
        with:
          tag: ${{ github.ref }}  # Use the tag that triggered the workflow
          files: ./output/**  # Path to the published output
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # Automatically provided by GitHub Actions
